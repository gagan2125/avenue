import { useState, useEffect } from "react";
import { Link, useNavigate } from "react-router-dom";
import { trackPageView, trackEvent } from "../../utils/analytics";

export default function EventTypeSelection() {
    const [eventType, setEventType] = useState(null); // 'ticketed' or 'rsvp'
    const navigate = useNavigate();

    useEffect(() => {
        // Track event creation page view
        trackPageView('Event Type Selection', {
            section: 'organizer',
            page: 'create_event'
        });
    }, []);

    const handleEventTypeSelect = (type) => {
        setEventType(type);
        
        // Track event type selection
        trackEvent('event_type_selected', {
            event_type: type
        });
    };

    const handleContinue = () => {
        // Track continue button click
        trackEvent('create_event_continue', {
            event_type: eventType
        });
        
        if (eventType === "ticketed") {
            navigate(`/organizer/create-ticket/ticketedevent/${eventType}`);
        } else {
            navigate("/organizer/create-ticket/rsvp");
        }
    };

    const Header = () => (
        <div className="fixed top-0 left-0 right-0 bg-[#111111] border-b border-white/10 z-50">
            <div className="h-16 px-4 md:px-6 flex items-center justify-between">
                <Link to="/organizer/dashboard" className="flex items-center gap-2">
                    <svg width="120" height="38" viewBox="0 0 600 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_3005_203)">
                            <path d="M0.419336 67.5563C0.219336 67.5563 0.119336 67.4563 0.0193359 67.3563C-0.0806641 67.1563 -0.0806641 67.0563 0.0193359 66.9563L36.0193 -0.0436554C36.0193 -0.143655 36.1193 -0.243652 36.3193 -0.243652H45.9193C46.0193 -0.243652 46.2193 -0.143655 46.3193 -0.0436554L82.2193 66.8563C82.3193 66.9563 82.3193 67.0563 82.2193 67.2563C82.1193 67.3563 82.0193 67.4563 81.8193 67.4563H67.4193C67.2193 67.4563 67.1193 67.3563 67.0193 67.2563L41.4193 19.5563C41.3193 19.3563 41.2193 19.3563 41.0193 19.3563C40.9193 19.3563 40.7193 19.4563 40.6193 19.5563L15.2193 67.3563C15.1193 67.4563 15.0193 67.5563 14.8193 67.5563H0.419336Z" fill="white" />
                            <path d="M83.9374 0.556534C83.7374 0.156534 83.8374 -0.043457 84.3374 -0.043457H98.8374C98.9374 -0.043457 99.1374 0.0565399 99.2374 0.15654L124.837 47.7565C124.937 47.9565 125.037 47.9565 125.237 47.9565C125.437 47.9565 125.537 47.8565 125.637 47.7565L151.237 0.15654C151.237 -0.0434601 151.437 -0.043457 151.637 -0.043457H165.937C166.337 -0.043457 166.437 0.156534 166.337 0.556534L130.437 67.4565C130.337 67.5565 130.237 67.6565 130.037 67.6565H120.437C120.237 67.6565 120.237 67.5565 120.137 67.4565L83.9374 0.556534Z" fill="white" />
                            <path d="M172.855 27.2565C172.855 26.9565 172.955 26.8564 173.255 26.8564H227.655C227.955 26.8564 228.155 26.9565 228.155 27.2565V40.1564C228.155 40.4564 227.955 40.5564 227.655 40.5564H186.655C186.455 40.5564 186.255 40.6565 186.255 40.9565V53.4565C186.255 53.6565 186.355 53.8564 186.655 53.8564H227.855C228.055 53.9564 228.155 54.0564 228.255 54.0564C228.355 54.0564 228.355 54.1564 228.355 54.3564V67.1564C228.355 67.4564 228.155 67.6564 227.855 67.6564H173.355C173.055 67.6564 172.855 67.4564 172.855 67.1564V27.2565ZM173.255 13.3564C172.955 13.3564 172.855 13.2565 172.855 12.9565V0.356445C172.955 0.0564453 173.155 -0.143555 173.355 -0.143555H227.855C228.155 -0.0435547 228.355 0.156445 228.355 0.356445V12.9565C228.355 13.2565 228.155 13.4565 227.855 13.4565H173.255V13.3564Z" fill="white" />
                            <path d="M240.174 0.156342C240.174 -0.0436585 240.274 -0.243652 240.574 -0.243652H254.874C254.974 -0.243652 255.074 -0.143661 255.174 -0.143661L299.074 49.5563C299.274 49.7563 299.374 49.7563 299.574 49.7563C299.774 49.6563 299.774 49.5563 299.774 49.3563V0.356339C299.974 0.0563385 300.074 -0.143661 300.274 -0.143661H313.074C313.374 -0.0436615 313.574 0.156338 313.574 0.356339V67.0563C313.574 67.3563 313.374 67.5563 313.074 67.5563H297.074C296.974 67.5563 296.874 67.5563 296.774 67.4563C293.574 63.8563 289.874 59.6563 285.574 54.8563C281.874 50.7563 277.474 45.7563 272.274 39.8563C267.074 33.9563 261.074 27.1563 254.374 19.4563C254.274 19.2563 254.174 19.2563 253.974 19.3563C253.774 19.4563 253.774 19.5563 253.774 19.7563V67.2563C253.774 67.5563 253.574 67.7563 253.174 67.7563H240.674C240.374 67.7563 240.274 67.6563 240.274 67.3563V0.156342H240.174Z" fill="white" />
                            <path d="M325.421 0.156342C325.421 -0.0436585 325.521 -0.243652 325.821 -0.243652H338.721C339.021 -0.243652 339.121 -0.143658 339.121 0.156342V35.6563C339.121 39.8563 339.721 43.1563 340.921 45.5563C342.121 47.9563 343.721 49.7563 345.721 50.9563C347.721 52.1563 350.021 52.9563 352.621 53.2563C355.221 53.5563 357.921 53.7563 360.721 53.8563C364.021 53.9563 366.921 53.7563 369.621 53.1563C372.321 52.5563 374.621 51.5563 376.521 50.1563C378.421 48.7563 379.921 46.8563 381.021 44.3563C382.121 41.9563 382.621 38.9563 382.621 35.2563V0.156342C382.621 -0.0436585 382.721 -0.243652 383.021 -0.243652H395.921C396.121 -0.243652 396.321 -0.143658 396.321 0.156342V34.5563C396.321 39.2563 395.821 43.2563 394.821 46.7563C393.821 50.2563 392.421 53.1563 390.721 55.5563C389.021 57.9563 386.921 59.9563 384.621 61.5563C382.321 63.0563 379.821 64.3563 377.121 65.1563C374.521 66.0563 371.721 66.6563 369.021 66.9563C366.221 67.2563 363.521 67.4563 360.821 67.4563C356.521 67.4563 352.321 67.0563 348.021 66.1563C343.821 65.2563 340.021 63.6563 336.621 61.2563C333.221 58.8563 330.521 55.4563 328.421 51.1563C326.321 46.8563 325.321 41.2563 325.321 34.5563V0.156342H325.421Z" fill="white" />
                            <path d="M408.227 27.2565C408.227 26.9565 408.327 26.8564 408.627 26.8564H463.027C463.327 26.8564 463.527 26.9565 463.527 27.2565V40.1564C463.527 40.4564 463.327 40.5564 463.027 40.5564H422.027C421.827 40.5564 421.627 40.6565 421.627 40.9565V53.4565C421.627 53.6565 421.727 53.8564 422.027 53.8564H463.127C463.327 53.9564 463.427 54.0564 463.527 54.0564C463.627 54.0564 463.627 54.1564 463.627 54.3564V67.1564C463.627 67.4564 463.427 67.6564 463.127 67.6564H408.727C408.427 67.6564 408.227 67.4564 408.227 67.1564V27.2565ZM408.727 13.3564C408.427 13.3564 408.327 13.2565 408.327 12.9565V0.356445C408.427 0.0564453 408.627 -0.143555 408.827 -0.143555H463.327C463.627 -0.0435547 463.827 0.156445 463.827 0.356445V12.9565C463.827 13.2565 463.627 13.4565 463.327 13.4565H408.727V13.3564Z" fill="white" />
                        </g>
                        <defs>
                            <clipPath id="clip0_3005_203">
                                <rect width="600" height="70" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                </Link>

                <button
                    onClick={() => window.history.back()}
                    className="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/5"
                >
                    <svg
                        width="20"
                        height="20"
                        viewBox="0 0 20 20"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M15 5L5 15M5 5L15 15"
                            stroke="white"
                            strokeWidth="1.67"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                        />
                    </svg>
                </button>
            </div>
        </div>
    );

    return (
        <div className="min-h-screen bg-[#111111]">
            <Header />
            <div className="pt-16 min-h-screen max-w-2xl mx-auto flex items-center justify-center p-4">
                <div className="w-full flex flex-col items-center gap-8">
                    <div className="text-center">
                        <h2 className="text-2xl font-semibold text-white mb-2">
                            What kind of event are you creating?
                        </h2>
                        <p className="text-white/60 text-sm">
                            Pick the type that best fits your event goals and ticket needs
                        </p>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 w-full">
                        {/* Ticketed Event Card */}
                        <button
                            onClick={() => handleEventTypeSelect("ticketed")}
                            className={`flex flex-col gap-3 p-6 rounded-xl border ${eventType === "ticketed"
                                ? "border-[#34B2DA]"
                                : "border-white/10"
                                } bg-[#1A1A1A] hover:bg-white/5 transition-colors text-left w-full group`}
                        >
                            <div className="w-10 h-10 rounded-lg bg-[#34B2DA]/10 flex items-center justify-center">
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 16 16"
                                    fill="none"
                                >
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M1 4.5C1 4.10218 1.15804 3.72064 1.43934 3.43934C1.72064 3.15804 2.10218 3 2.5 3H13.5C13.8978 3 14.2794 3.15804 14.5607 3.43934C14.842 3.72064 15 4.10218 15 4.5V5.5C15 5.776 14.773 5.994 14.505 6.062C14.0743 6.1718 13.6925 6.42192 13.4198 6.77286C13.1472 7.1238 12.9991 7.55557 12.9991 8C12.9991 8.44443 13.1472 8.8762 13.4198 9.22714C13.6925 9.57808 14.0743 9.8282 14.505 9.938C14.773 10.006 15 10.224 15 10.5V11.5C15 11.8978 14.842 12.2794 14.5607 12.5607C14.2794 12.842 13.8978 13 13.5 13H2.5C2.10218 13 1.72064 12.842 1.43934 12.5607C1.15804 12.2794 1 11.8978 1 11.5V10.5C1 10.224 1.227 10.006 1.495 9.938C1.92565 9.8282 2.30747 9.57808 2.58016 9.22714C2.85285 8.8762 3.00088 8.44443 3.00088 8C3.00088 7.55557 2.85285 7.1238 2.58016 6.77286C2.30747 6.42192 1.92565 6.1718 1.495 6.062C1.227 5.994 1 5.776 1 5.5V4.5ZM10 5.75C10 5.55109 10.079 5.36032 10.2197 5.21967C10.3603 5.07902 10.5511 5 10.75 5C10.9489 5 11.1397 5.07902 11.2803 5.21967C11.421 5.36032 11.5 5.55109 11.5 5.75V6.75C11.5 6.94891 11.421 7.13968 11.2803 7.28033C11.1397 7.42098 10.9489 7.5 10.75 7.5C10.5511 7.5 10.3603 7.42098 10.2197 7.28033C10.079 7.13968 10 6.94891 10 6.75V5.75ZM10.75 8.5C10.5511 8.5 10.3603 8.57902 10.2197 8.71967C10.079 8.86032 10 9.05109 10 9.25V10.25C10 10.4489 10.079 10.6397 10.2197 10.7803C10.3603 10.921 10.5511 11 10.75 11C10.9489 11 11.1397 10.921 11.2803 10.7803C11.421 10.6397 11.5 10.4489 11.5 10.25V9.25C11.5 9.05109 11.421 8.86032 11.2803 8.71967C11.1397 8.57902 10.9489 8.5 10.75 8.5Z"
                                        fill="#89DBF0"
                                    />
                                </svg>
                            </div>
                            <div>
                                <h3 className="font-medium text-white mb-1">Ticketed event</h3>
                                <p className="text-sm text-white/60">
                                    Sell tickets with multiple pricing tiers, manage fees, and
                                    track attendance
                                </p>
                            </div>
                        </button>

                        {/* RSVP Event Card */}
                        <button
                            onClick={() => handleEventTypeSelect("rsvp")}
                            className={`flex flex-col gap-3 p-6 rounded-xl border ${eventType === "rsvp" ? "border-[#34B2DA]" : "border-white/10"
                                } bg-[#1A1A1A] hover:bg-white/5 transition-colors text-left w-full group`}
                        >
                            <div className="w-10 h-10 rounded-lg bg-[#34B2DA]/10 flex items-center justify-center">
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 16 16"
                                    fill="none"
                                >
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M15 8C15 9.85652 14.2625 11.637 12.9497 12.9497C11.637 14.2625 9.85652 15 8 15C6.14348 15 4.36301 14.2625 3.05025 12.9497C1.7375 11.637 1 9.85652 1 8C1 6.14348 1.7375 4.36301 3.05025 3.05025C4.36301 1.7375 6.14348 1 8 1C9.85652 1 11.637 1.7375 12.9497 3.05025C14.2625 4.36301 15 6.14348 15 8ZM6 8C6.552 8 7 7.328 7 6.5C7 5.672 6.552 5 6 5C5.448 5 5 5.672 5 6.5C5 7.328 5.448 8 6 8ZM11 6.5C11 7.328 10.552 8 10 8C9.448 8 9 7.328 9 6.5C9 5.672 9.448 5 10 5C10.552 5 11 5.672 11 6.5ZM11.005 10.745C10.8644 10.6045 10.6738 10.5257 10.475 10.5257C10.2762 10.5257 10.0856 10.6045 9.945 10.745C9.68962 11.0005 9.38641 11.2032 9.05268 11.3415C8.71895 11.4797 8.36124 11.5509 8 11.5509C7.63876 11.5509 7.28105 11.4797 6.94732 11.3415C6.61359 11.2032 6.31038 11.0005 6.055 10.745C5.91282 10.6125 5.72478 10.5404 5.53048 10.5438C5.33618 10.5473 5.15079 10.626 5.01338 10.7634C4.87597 10.9008 4.79725 11.0862 4.79383 11.2805C4.7904 11.4748 4.86252 11.6628 4.995 11.805C5.79201 12.6019 6.87293 13.0496 8 13.0496C9.12707 13.0496 10.208 12.6019 11.005 11.805C11.1455 11.6644 11.2243 11.4738 11.2243 11.275C11.2243 11.0762 11.1455 10.8856 11.005 10.745Z"
                                        fill="#DAB4FE"
                                    />
                                </svg>
                            </div>
                            <div>
                                <h3 className="font-medium text-white mb-1">RSVP event</h3>
                                <p className="text-sm text-white/60">
                                    Create a free event and track attendance with simple guest
                                    list
                                </p>
                            </div>
                        </button>
                    </div>

                    {/* Continue Button - Only shows when an option is selected */}
                    {eventType && (
                        <button
                            onClick={handleContinue}
                            className="w-fit px-5 h-10 flex items-center justify-center rounded-full bg-white text-black font-semibold text-sm hover:ring-2 hover:ring-[#34B2DA] ring-offset-2 ring-offset-black"
                        >
                            Continue with {eventType === "ticketed" ? "Ticketed" : "RSVP"}{" "}
                            Event
                        </button>
                    )}
                </div>
            </div>
        </div>
    );
}